webpackJsonp([3],{"++6+":function(t,e,a){t.exports=a.p+"static/img/005.bb17b7e.png"},"1Jsg":function(t,e,a){t.exports=a.p+"static/img/006.a81724e.png"},"40Bx":function(t,e,a){t.exports=a.p+"static/img/010.18a9f49.png"},"4IyY":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("gBtx"),i=a.n(s),n=a("mvHQ"),r=a.n(n),o=a("Dd8w"),c=a.n(o),d=a("KHXw"),p=a("CHm6"),u={name:"order-package-card",props:{packageOrder:{type:Object,default:null}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-card"},[a("div",{staticClass:"row-hd"},[a("span",{staticClass:"row-hd-l",style:"background-image:url("+t.packageOrder.Image+")"}),a("div",{staticClass:"row-hd-r"},[a("div",{staticClass:"name"},[t._v(t._s(t.packageOrder.Name))]),a("div",{staticClass:"detail"},[a("span",{staticClass:"price"},[t._v("¥"+t._s(t._f("formatNumber")(t.packageOrder.OrderMoney)))])])])])])},staticRenderFns:[]};var m=a("VU/8")(u,l,!1,function(t){a("93Lt")},"data-v-0df1f9be",null).exports,g=a("BEBN"),f={name:"order-list",mixins:[app.mixin.shareMixin],data:function(){return{headerList:["全部","待付款","已付款","待评价"],stype:-1,list:[],isLoading:!0,isPaySkip:!1,wxTitle:"我的订单",pagingOption:{api:g.z,params:{},autoLoadFirst:!1},queryPara:[{Status:null,IsExpired:null,IsComment:null},{Status:1,IsExpired:!1,IsComment:null},{Status:[2,3],IsExpired:null,IsComment:null},{Status:[2,3],IsExpired:null,IsComment:!1}],timeout:null}},computed:c()({},Vuex.mapState(["config","orderListRefreshFlag"])),methods:c()({},Vuex.mapMutations(["set_userPageRefreshFlag"]),{getAmount:function(t){var e=0;return t.Items.forEach(function(t){1==t.Type||3==t.Type?e+=1:2==t.Type&&(e+=parseInt(t.Amount))}),e},getStatusStr:function(t){return 0==t.Status?"交易关闭":1==t.Status?t.IsExpired?"交易过期":"等待付款":2==t.Status||3==t.Status?"交易成功":void 0},changeStatus:function(t){this.stype=t},renderData:function(t){var e=this;t.then(function(t){e.isLoading=!1,t.ErrorCode==app.errok&&(1===t.PageIndex&&(e.list=[]),e.list=e.list.concat(t.Data),clearTimeout(e.timeout),0!=e.stype&&1!=e.stype||e._diffOrderTime())})},gotoDetail:function(t){this.$router.push({path:"/orderDetail",query:{orderId:t}})},gotoComment:function(t){this.$router.push({path:"/orderComment",query:{orderId:t,type:1}})},deleteOrder:function(t,e){var a=this,s=["关闭","删除"],i=0==t?g.G:g.H;app.confirm("确定"+s[t]+"该订单吗？").then(function(n){!0===n&&i({ID:e}).then(function(e){e.ErrorCode==app.errok?(app.toast("success",s[t]+"订单成功。"),a.renderPage()):app.toast("error",e.ErrorMsg)})})},payOrder:function(t){var e=this;this.isPaySkip||(this.isPaySkip=!0,Object(g.D)({ID:t}).then(function(t){if(t.ErrorCode==app.errok)if(e.isPaySkip=!1,"miniprogram"===window.__wxjs_environment){var a="succUrl="+encodeURIComponent(window.location.href.match(/[^#]*#/)[0]+"/orderList/1"),s="failUrl="+encodeURIComponent(window.location.href.match(/[^#]*#/)[0]+"/orderList/1"),i="info="+encodeURIComponent(r()({OrderNumber:t.Data.OrderNumber,CompanyName:t.Data.CompanyName,StudentName:t.Data.StudentName,PayMoney:t.Data.PayMoney,Product:t.Data.ProductItem})),n="data="+encodeURIComponent(t.Data.PayInfo);wx.miniProgram.navigateTo({url:"/pages/payment/payment?"+a+"&"+s+"&"+n+"&"+i,success:function(){},fail:function(){app.alert("跳转失败，请刷新页面重试。")}})}else try{document.getElementById("wxData").value=t.Data.WXData,document.getElementById("wxPayForm").action=t.Data.PayURL,document.getElementById("wxPayForm").submit()}catch(t){app.toast("error",t.message)}else 423==t.ErrorCode?app.alert("您有一笔未支付未过期的预制订单，可前往“师生信->个人中心->预制订单”进行支付。"):t.ErrorMsg&&app.toast("error",t.ErrorMsg);e.isPaySkip=!1}))},renderPage:function(){this.isLoading=!0,this.list=[],this.$refs.pagingScroller.refresh(this.queryPara[this.stype]),this.set_userPageRefreshFlag()},_diffOrderTime:function(){var t=this;this.timeout=setTimeout(function(){var e=0;t.list.forEach(function(a,s){1!=a.Status||a.IsExpired||(e++,a.ExpiredSeconds--,a.ExpiredSeconds<=0&&(a.IsExpired=!0,1==t.stype&&t.list.splice(s,1)))}),e>0?t._diffOrderTime():clearTimeout(t.timeout)},1e3)}}),created:function(){var t=this;this.stype=i()(this.$route.params.status),app.event.on("appActive",function(e,a){var s=a.diffTime;t.list.forEach(function(e,a){1!=e.Status||e.IsExpired||(e.ExpiredSeconds-=s,e.ExpiredSeconds<=0&&(e.IsExpired=!0,1==t.stype&&t.list.splice(a,1)))})})},beforeDestroy:function(){app.event.off("appActive")},watch:{stype:function(t,e){this.renderPage()},orderListRefreshFlag:function(t,e){this.renderPage()}},components:{OrderCard:d.a,EmptyPage:p.a,OrderPackageCard:m}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-list"},[a("div",{staticClass:"header"},t._l(t.headerList,function(e,s){return a("router-link",{key:s,staticClass:"header-item-wrap",attrs:{tag:"div",to:"/orderList/"+s,replace:""},nativeOn:{click:function(e){t.changeStatus(s)}}},[a("div",{staticClass:"header-item",class:{active:s===t.stype}},[t._v(t._s(e))])])})),a("div",{staticClass:"body"},[a("scroller-super",{ref:"pagingScroller",staticClass:"scroller",attrs:{type:2,data:t.list,pagingOption:t.pagingOption},on:{loadData:t.renderData}},[a("div",{staticClass:"void"}),t._l(t.list,function(e){return a("div",{staticClass:"card"},[a("div",{staticClass:"card-hd"},[a("span",{staticClass:"campus"},[t._v(t._s(e.CampusName))]),a("span",{staticClass:"card-hd-r"},[1!=e.Status||e.IsExpired?t._e():a("span",{staticClass:"time"},[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-riqiicon"}})]),t._v("剩"+t._s(t._f("formatSeconds")(e.ExpiredSeconds))+"\n\t\t\t\t\t\t\t")]),e.ErrorMessage?a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-quanjutishijinggao"}})]):t._e(),a("span",{staticClass:"status"},[t._v(t._s(t.getStatusStr(e)))])])]),a("div",{staticClass:"card-bd",on:{click:function(a){t.gotoDetail(e.ID)}}},[t._l(e.Items,function(s){return 1==e.Type?a("div",[a("order-card",{attrs:{product:s,type:1,campus:e}})],1):t._e()}),10==e.Type?a("div",[a("order-package-card",{attrs:{packageOrder:e}})],1):t._e()],2),a("div",{staticClass:"card-ft"},[a("div",{staticClass:"total"},[a("span",{staticClass:"inline-block"},[t._v("共"+t._s(t.getAmount(e))+"件商品 ")]),e.IsPreMoney?a("span",{staticClass:"inline-block"},[t._v("定金：\n                                "),a("span",{staticClass:"money"},[t._v("¥"+t._s(t._f("formatNumber")(e.PreMoney)))])]):t._e(),a("span",{staticClass:"inline-block"},[t._v("\n                                实付款："),a("span",{staticClass:"money"},[t._v("¥"+t._s(t._f("formatNumber")(e.PayMoney)))])])]),a("div",[1!=e.Status||e.IsExpired?t._e():a("span",{staticClass:"btn default",on:{click:function(a){t.payOrder(e.ID)}}},[t._v("立即支付")]),1==e.Status?a("span",{staticClass:"btn default1",on:{click:function(a){t.deleteOrder(0,e.ID)}}},[t._v("关闭订单")]):t._e(),0==e.Status?a("span",{staticClass:"btn default1",on:{click:function(a){t.deleteOrder(1,e.ID)}}},[t._v("删除订单")]):t._e(),2!=e.Status&&3!=e.Status||e.IsComment?t._e():a("span",{staticClass:"btn default",on:{click:function(a){t.gotoComment(e.ID)}}},[t._v("等待评价")]),2!=e.Status&&3!=e.Status||!e.IsComment?t._e():a("span",{staticClass:"btn default1"},[t._v("评价成功")])])]),a("div",{staticClass:"void"})])}),0===t.list.length?a("empty-page",{staticClass:"noData_temp",attrs:{type:5}}):t._e()],2)],1),a("loading",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}],staticClass:"loading"})],1)},staticRenderFns:[]};var v=a("VU/8")(f,h,!1,function(t){a("77aE")},"data-v-394638d0",null);e.default=v.exports},"77aE":function(t,e){},"8sHD":function(t,e,a){var s=a("kM2E"),i=a("KpO7");s(s.S+s.F*(Number.parseInt!=i),"Number",{parseInt:i})},"93Lt":function(t,e){},"975W":function(t,e){},BFOb:function(t,e,a){t.exports=a.p+"static/img/008.1fcbced.png"},CHm6:function(t,e,a){"use strict";var s=a("cfO4"),i=a.n(s),n=a("FY0F"),r=a.n(n),o=a("tT1C"),c=a.n(o),d=a("kkZd"),p=a.n(d),u=a("MEQb"),l=a.n(u),m=a("y0RW"),g=a.n(m),f=a("rbbm"),h=a.n(f),v=a("++6+"),_=a.n(v),y=a("1Jsg"),C=a.n(y),x=a("l8Qa"),b=a.n(x),S=a("BFOb"),I=a.n(S),w=a("YS88"),E=a.n(w),k=a("40Bx"),D=a.n(k),O=a("TXKF"),P=a.n(O),T={name:"empty-page",props:{type:{default:1}},data:function(){return{pages:{no404:{img:r.a,width:294,height:204,text:"抱歉，您找的页面可能去睡觉了"},no1000:{img:i.a,width:294,height:254,text:""},no0:{img:c.a,width:291,height:253,text:"商城已经打烊了"},no1:{img:p.a,width:200,height:270,text:"暂无结果，试试别的关键词吧"},no2:{img:l.a,width:200,height:270,text:"快来做第一个评论的人吧～"},no3:{img:g.a,width:200,height:270,text:"快来做第一个提问的人吧～"},no4:{img:h.a,width:292,height:253,text:"没有找到您心仪的商品，更换个条件试试吧"},no5:{img:_.a,width:412,height:253,text:"您的订单记录空空如也～"},no6:{img:C.a,width:290,height:252,text:"暂无优惠券哦～"},no7:{img:b.a,width:291,height:254,text:"除了我以外就没有别的喜欢的吗～"},no8:{img:I.a,width:290,height:252,text:"这里一个地址也没有～"},no9:{img:E.a,width:292,height:145,text:"没有找到您心仪的班级，更换个条件试试吧"},no10:{img:D.a,width:292,height:253,text:"商品卖完了，想买要趁早哦！"},no11:{img:P.a,width:290,height:253,text:"暂无商品，请到别的地方看看吧！"},no12:{img:P.a,width:290,height:253,text:"暂无结果，请到别的地方看看吧！"}}}},computed:{page:function(){var t=this.pages["no"+this.type];return{class:"img"+this.type,style:{width:t.width/2+"px",height:t.height/2+"px",backgroundImage:"url("+t.img+")"},text:t.text}}}},N={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"empty-box"},[e("div",{staticClass:"empty-img",class:this.page.class,style:this.page.style}),e("div",{staticClass:"empty-tips"},[this._v(this._s(this.page.text))])])},staticRenderFns:[]};var M=a("VU/8")(T,N,!1,function(t){a("mfgg")},"data-v-2993be6c",null);e.a=M.exports},FY0F:function(t,e,a){t.exports=a.p+"static/img/404.49a5047.png"},KHXw:function(t,e,a){"use strict";var s={name:"order-card",props:{product:{type:Object,default:null},campus:{type:Object,default:null},type:{}},methods:{gotoDetail:function(t){2==this.type&&this.$router.push({path:"/details/"+t.Type+"/"+t.ProductCampusID})}},mounted:function(){window.b=this}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-card",on:{click:function(e){t.gotoDetail(t.product)}}},[a("div",{staticClass:"row-hd",class:{fade:2==t.type}},[a("span",{staticClass:"row-hd-l",style:"background-image:url("+t.product.Image+")"}),a("div",{staticClass:"row-hd-r"},[a("div",{staticClass:"name"},[t._v(t._s(t.product.Name))]),1==t.product.Type?a("div",{staticClass:"content"},[t.product.OpenDate?a("div",[a("label",[t._v("开班日期：")]),t._v(t._s(t._f("formatDatetime")(t.product.OpenDate,"yyyy-MM-dd")))]):t._e(),t.product.CourseTime?a("div",[a("label",[t._v("上课时间：")]),t._v(t._s(t.product.CourseTime))]):t._e(),t.product.SeatRow>0&&t.product.SeatColumn>0?a("div",[a("label",[t._v("已选座位：")]),t._v("\n\t\t\t\t\t"+t._s(t.product.SeatName)+"\n\t\t\t\t")]):t._e(),t.product.ProductAmount?a("div",[a("label",[t._v("课程数量：")]),t._v(t._s(t.product.ProductAmount)+t._s(t.product.Unit)+"\n\t\t\t\t")]):t._e()]):t._e(),3==t.product.Type?a("div",{staticClass:"content"},[t.product.ClassName?a("div",[a("label",[t._v("所选班级：")]),t._v(t._s(t.product.ClassName))]):t._e(),t.product.OpenDate?a("div",[a("label",[t._v("开班日期：")]),t._v(t._s(t._f("formatDatetime")(t.product.OpenDate,"yyyy-MM-dd")))]):t._e(),t.product.CourseTime?a("div",[a("label",[t._v("上课时间：")]),t._v(t._s(t.product.CourseTime))]):t._e(),t.product.SeatName?a("div",[a("label",[t._v("已选座位：")]),t._v("\n\t\t\t\t\t"+t._s(t.product.SeatName)+"\n\t\t\t\t")]):t._e(),t.product.ProductAmount?a("div",[a("label",[t._v("课程数量：")]),t._v(t._s(t.product.ProductAmount)+t._s(t.product.Unit)+"\n\t\t\t\t")]):t._e()]):t._e(),(2==t.product.Type||4==t.product.Type)&&t.product.SpecItems.length>0?a("div",{staticClass:"content"},t._l(t.product.SpecItems,function(e){return a("div",[a("label",[t._v(t._s(e.Name)+"：")]),t._v(t._s(e.Value))])})):t._e(),a("div",{staticClass:"detail"},[a("span",[t.product.Price?a("span",{staticClass:"price",class:{small:1==t.type}},[t._v("\n\t\t\t\t\t\t¥"+t._s(t.product.Price)+"\n\t\t\t\t\t")]):t._e(),t.product.SingleSchemeName?a("span",{staticClass:"scheme-tag"},[t._v(t._s(t.product.SingleSchemeName))]):t._e()]),2==t.product.Type||4==t.product.Type?a("span",{staticClass:"count"},[t._v("x"+t._s(t.product.Amount))]):t._e()])])]),(1==t.product.Type||3==t.product.Type)&&t.product.Bindings.length>0?a("div",{staticClass:"row-bd"},[a("div",{staticClass:"row-bd-l"},[t._v("已选物品：")]),a("div",{staticClass:"row-bd-r"},t._l(t.product.Bindings,function(e){return a("div",{staticClass:"item"},[a("div",{staticClass:"item-name"},[t._v(t._s(e.Name))]),a("div",[t._v("¥"+t._s(t._f("formatNumber")(e.Price)))])])}))]):t._e()])},staticRenderFns:[]};var n=a("VU/8")(s,i,!1,function(t){a("975W")},"data-v-3a043ee4",null);e.a=n.exports},KpO7:function(t,e,a){var s=a("7KvD").parseInt,i=a("mnVu").trim,n=a("hyta"),r=/^[-+]?0[xX]/;t.exports=8!==s(n+"08")||22!==s(n+"0x16")?function(t,e){var a=i(String(t),3);return s(a,e>>>0||(r.test(a)?16:10))}:s},MEQb:function(t,e,a){t.exports=a.p+"static/img/002.0b83c59.png"},TXKF:function(t,e,a){t.exports=a.p+"static/img/011.74326b2.png"},YS88:function(t,e,a){t.exports=a.p+"static/img/009.a401fd9.png"},cfO4:function(t,e,a){t.exports=a.p+"static/img/1000.30cdd05.png"},gBtx:function(t,e,a){t.exports={default:a("qrpI"),__esModule:!0}},hyta:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},kkZd:function(t,e,a){t.exports=a.p+"static/img/001.de905a8.png"},l8Qa:function(t,e,a){t.exports=a.p+"static/img/007.e462516.png"},mfgg:function(t,e){},mnVu:function(t,e,a){var s=a("kM2E"),i=a("52gC"),n=a("S82l"),r=a("hyta"),o="["+r+"]",c=RegExp("^"+o+o+"*"),d=RegExp(o+o+"*$"),p=function(t,e,a){var i={},o=n(function(){return!!r[t]()||"​"!="​"[t]()}),c=i[t]=o?e(u):r[t];a&&(i[a]=c),s(s.P+s.F*o,"String",i)},u=p.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(d,"")),t};t.exports=p},mvHQ:function(t,e,a){t.exports={default:a("qkKv"),__esModule:!0}},qkKv:function(t,e,a){var s=a("FeBl"),i=s.JSON||(s.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},qrpI:function(t,e,a){a("8sHD"),t.exports=parseInt},rbbm:function(t,e,a){t.exports=a.p+"static/img/004.0fbc03b.png"},tT1C:function(t,e,a){t.exports=a.p+"static/img/000.438402b.png"},y0RW:function(t,e,a){t.exports=a.p+"static/img/003.3e0fba5.png"}});